import numpy as np
import pandas as pd

df = pd.read_csv("benchmarks/preprocessed_traces/arxiv_summarization_filtered_stats_llama2_tokenizer.csv")
df = df[(df["num_prefill_tokens"] + df["num_decode_tokens"]) <= 32768]
print(df["num_prefill_tokens"].describe(), df["num_decode_tokens"].describe(), np.percentile(df["num_prefill_tokens"], [90]), np.percentile(df["num_decode_tokens"], [90]))

df = pd.read_csv("benchmarks/preprocessed_traces/sharegpt_8k_filtered_stats_llama2_tokenizer.csv")
df = df[(df["num_prefill_tokens"] + df["num_decode_tokens"]) <= 32768]
print(df["num_prefill_tokens"].describe(), df["num_decode_tokens"].describe(), np.percentile(df["num_prefill_tokens"], [90]), np.percentile(df["num_decode_tokens"], [90]))

lens = [11220, 17374, 1419, 10092, 10345, 12430, 11899, 2544, 8829, 12534, 7938, 8981, 1808, 2988, 13005, 5261, 20052, 3897, 20059, 3050, 11281, 11154, 3828, 11551, 3049, 10236, 19369, 4871, 4742, 5913, 14690, 1500, 12140, 4551, 3312, 6668, 5828, 4632, 10902, 16828, 2620, 6019, 3563, 4809, 4961, 8452, 19455, 16326, 10006, 4413, 9911, 3344, 7084, 14980, 9604, 3983, 3849, 8425, 7795, 3134, 12771, 5532, 19815, 1112, 13028, 3045, 3203, 16486, 8741, 9849, 16632, 6775, 14162, 14073, 4185, 50100, 7717, 16736, 19230, 11699, 4754, 11168, 3775, 11363, 18921, 4797, 3901, 3750, 3828, 9665, 5186, 6986, 12013, 5682, 6484, 16186, 8378, 10739, 15836, 5342, 30984, 5248, 14815, 7290, 5818, 23593, 16007, 9225, 2861, 2229, 10309, 7842, 5302, 3140, 787, 10154, 5364, 3728, 9712, 7198, 12399, 19162, 5722, 4373, 5197, 2754, 12673, 14863, 8454, 4870, 11204, 21631, 7442, 2314, 14369, 3707, 13479, 10409, 4338, 11917, 12273, 4107, 13097, 13203, 6775, 11146, 3202, 6251, 5277, 6410, 3758, 4507, 7814, 13866, 9764, 3819, 6273, 5371, 10893, 4858, 5545, 4725, 7964, 4106, 4632, 13493, 19975, 20230, 12399, 8440, 12158, 14602, 16969, 1244, 3011, 14288, 6512, 4175, 5187, 4274, 17533, 9173, 16807, 8058, 23903, 3523, 2787, 6486, 6540, 5068, 6753, 15679, 11175, 15837, 3448, 9655, 11709, 11940, 3470, 3360, 19610, 16413, 3082, 6334, 3614, 4394, 3190, 8858, 41061, 8209, 6549, 15375, 16479, 31441, 6535, 8440, 6314, 5042, 6657, 5764, 4737, 10060, 8070, 30698, 9871, 11730, 21100, 7093, 4499, 10199, 12609, 4595, 17855, 4784, 4664, 16838, 16614, 12414, 8922, 7393, 18348, 6409, 15440, 4400, 17772, 4867, 4465, 7240, 3884, 20940, 4281, 13997, 10167, 10317, 25775, 13492, 10578, 7337, 7768, 3959, 17252, 16019, 13345, 7285, 9949, 3587, 6412, 4677, 7938, 3368, 14127, 11306, 4829, 14411, 10114, 5936, 13956, 12319, 15059, 1752, 12738, 4062, 5765, 5777, 4528, 1856, 13554, 791, 4915, 9472, 5473, 4622, 5338, 12248, 7966, 15507, 5452, 12615, 5582, 8469, 7164, 17539, 11495, 15210, 6598, 15736, 36161, 2514, 10849, 23059, 6234, 9726, 5769, 10834, 16021, 4194, 2946, 10224, 5338, 9035, 3301, 6625, 4424, 11173, 10186, 3854, 10351, 4049, 2598, 5970, 16625, 2974, 5613, 12568, 14431, 1835, 17768, 17086, 10712, 1149, 1866, 11230, 3300, 6804, 11602, 15756, 11905, 5762, 3782, 13729, 3241, 12766, 2797, 4866, 9111, 15877, 17630, 15702, 4019, 1435, 4615, 11411, 5015, 11441, 9375, 13195, 4232, 17278, 5801, 3654, 5824, 1616, 17185, 4678, 15525, 1355, 17771, 6105, 11875, 8831, 6147, 2791, 2027, 3595, 13982, 11761, 13647, 9259, 13722, 18595, 4473, 13101, 6242, 1882, 5304, 12589, 1873, 9048, 5322, 4401, 7566, 48952, 1911, 5482, 7471, 5013, 6967, 6564, 11865, 11743, 2126, 16058, 10047, 11100, 14883, 2982, 9930, 14200, 5632, 13369, 12227, 11079, 5422, 13186, 16686, 7492, 15502, 7004, 4476, 5762, 14182, 2760, 8262, 9262, 9314, 11564, 15493, 14199, 13186, 13745, 202, 8472, 7059, 14761, 1416, 11370, 7937, 7807, 5052, 5267, 5573, 4990, 12876, 11217, 9117, 14291, 8636, 10191, 7580, 12976, 11176, 3861, 15806, 10119, 1981, 13919, 5559, 4446, 15849, 12899, 3531, 4243, 2199, 14384, 5494, 13903, 11841, 6338, 12785, 11209, 9104, 12859, 14901, 24239, 12101, 8895, 11856, 6287, 9661, 16021, 5283, 8778, 4644, 30317, 4647, 22625, 22809, 3665, 5496, 12248, 3953, 9625, 1746, 6296, 7134, 10101, 5517, 16020, 2247, 3708, 3510, 10994, 4375, 11649, 9507, 11466, 13599, 18202, 5613, 1603, 10376, 4948, 13784, 6764, 2901, 7429, 13467, 8528, 14894, 11365, 12481, 16569, 15335, 12667, 1326, 4716, 3244, 6430, 10560, 10059, 1561, 9088, 13334, 9590, 18292, 10988, 5717, 10787, 5562, 16333, 9027, 9168, 8873, 5168, 29201, 19907, 4369, 2235, 14398, 2776, 14130, 20272, 17403, 4289, 12113, 17672, 2362, 15313, 4419, 3050, 5721, 2946, 12424, 3115, 3107, 13191, 10548, 5561, 1128, 6689, 5941, 3486, 7032, 11320, 5440, 3228, 5095, 11218, 3253, 16779, 16764, 4298, 21742, 10595, 17174, 4816, 7576, 9431, 10408, 11000, 23015, 4527, 12593, 7251, 24963, 8621, 13930, 7997, 8708, 5122, 13140, 4869, 3654, 10715, 5014, 10509, 7793, 6635, 4439, 5162, 6467, 1945, 9033, 4455, 12257, 14251, 384, 2839, 7277, 4419, 3505, 28955, 8075, 14927, 33243, 16221, 11268, 2560, 8900, 1184, 14608, 3682, 8520, 5418, 7626, 7610, 1637, 19802, 2717, 5674, 13594, 35017, 12138, 2388, 4217, 8537, 18033, 4124, 13048, 3059, 4120, 3183, 23060, 11865, 4966, 6741, 11617, 5554, 8930, 2067, 5159, 5040, 2976, 19506, 6738, 20270, 5612, 16926, 2307, 7295, 36381, 8945, 2358, 13863, 16251, 12540, 11251, 7316, 2779, 10377, 10587, 10367, 28039, 4753, 6991, 5086, 5470, 12364, 15239, 12621, 6560, 11372, 5280, 7994, 2738, 11771, 10507, 1966, 7505, 12717, 3842, 18535, 17613, 7353, 16359, 2440, 6189, 16780, 17771, 5517, 6947, 16566, 2778, 15063, 33112, 12489, 10844, 22030, 3181, 18470, 4944, 10417, 23392, 4610, 3532, 20228, 15565, 5672, 4480, 4606, 18833, 16928, 14937, 1973, 3780, 4450, 15036, 14577, 8987, 5121, 13696, 6944, 17016, 10343, 8555, 7226, 12277, 5721, 2681, 11255, 9246, 15739, 9872, 8466, 1244, 3362, 12677, 2561, 9716, 5864, 6309, 16471, 7469, 17987, 7783, 5704, 24997, 8051, 6514, 15069, 1907, 10386, 1435, 2182, 10187, 5481, 21332, 1706, 2683, 6418, 16585, 18742, 16854, 4449, 31647, 10490, 5812, 13651, 3340, 14967, 6494, 8438, 4505, 1782, 6871, 2978, 4975, 16095, 12184, 20945, 16591, 8000, 8748, 15934, 12087, 6072, 7222, 2899, 2548, 5772, 4421, 7822, 3775, 14967, 16812, 11557, 1395, 13056, 21999, 13471, 4863, 1241, 5424, 3216, 5738, 9844, 16304, 4526, 20819, 5120, 10779, 6263, 8190, 2786, 7700, 6661, 13572, 12030, 7257, 12722, 15387, 5525, 16816, 26442, 13750, 9960, 5589, 9821, 1689, 15827, 7742, 11713, 7832, 12970, 3265, 5245, 21072, 10760, 6137, 3293, 16936, 4493, 6274, 5649, 14710, 20781, 14006, 10526, 17112, 11690, 1067, 12240, 11850, 13302, 3122, 4091, 5550, 3648, 20072, 14742, 1626, 6357, 4888, 15806, 4689, 1998, 17792, 12127, 5636, 14100, 3878, 10906, 5211, 22636, 5453, 3404, 12401, 13875, 11687, 24918, 4772, 11324, 14762, 6054, 6496, 11387, 8692, 842, 12308, 9007, 7440, 12582, 16399, 944, 8643, 4385, 2513, 6617, 12954, 10524, 5013, 6813, 3306, 6769, 16410, 4700, 4682, 4814, 8980, 1130, 10994, 5624, 16087, 17063, 12908, 5251, 9220, 16461, 8053, 10624, 5512, 7745, 3694, 27717, 12202, 19821, 2050, 5515, 2291, 5419, 8585, 7264, 30069, 16712, 44301, 14988, 8743, 17111, 5801, 11559, 14468, 2965, 12579, 4553, 9345, 12622, 18899, 3743, 11160, 22536, 9871, 3287, 7476, 6079, 13882, 8570, 29597, 6324, 14405, 8909, 2439, 7683, 3534, 4149, 14997, 19930, 36628, 8601, 15893, 5911, ]

lens = np.array(lens)
print("Mean:", np.mean(lens))
print("Median:", np.median(lens))
print("90th Percentile:", np.percentile(lens, 90))
print("Standard Deviation:", np.std(lens))

import json
with open("logs_300/benchmark_models--Qwen--Qwen3-30B-A3B_256_64_32768_0.9_1_False_debug_staged-prefill_1_longbench_-1_8192_0.125_37.json", "r") as f:
    data = json.load(f)
    output_lens = [len(itl) for itl in data["itls"]]
output_lens = np.array(output_lens)
print("Output Lengths - Mean:", np.mean(output_lens))
print("Output Lengths - Median:", np.median(output_lens))
print("Output Lengths - 90th Percentile:", np.percentile(output_lens, 90))
print("Output Lengths - Standard Deviation:", np.std(output_lens))